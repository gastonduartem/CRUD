<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= title %></title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="title">
        <span class="logo">üóÇÔ∏è</span>
        <h1>Topics</h1>
      </div>
      <a class="btn btn--primary" href="/topics/new">+ Nuevo</a>
    </header>

    <!-- Mensaje vac√≠o -->
    <% if (!topics || topics.length === 0) { %>
      <div class="card card--empty">
        <h2 class="muted">A√∫n no hay topics</h2>
        <p>Crea tu primer topic para empezar a votar y ordenar.</p>
        <a class="btn btn--primary" href="/topics/new">Crear topic</a>
      </div>
    <% } else { %>

      <!-- Tabla -->
      <div class="card">
        <div class="table-top">
          <div class="muted">Ordenado por votos (desc)</div>
          <a class="btn btn--neutral" href="/">‚Üª Actualizar</a>
        </div>
        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th style="width:28%">T√≠tulo</th>
                <th style="width:36%">Descripci√≥n</th>
                <th style="width:10%">Votos</th>
                <th style="width:16%">Creado</th>
                <th style="width:10%" class="txt-right">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <% topics.forEach(t => { %>
                <tr>
                  <td class="title-cell">
                    <strong><%= t.title %></strong>
                    <% if (t.votes >= 10) { %>
                      <span class="badge">Popular</span>
                    <% } %>
                  </td>
                  <td class="muted"><%= t.description || '‚Äî' %></td>
                  <td><span class="kpi"><%= t.votes %></span></td>
                  <td class="muted"><%= t.created_at %></td>
                  <td class="txt-right">
                    <div class="actions">
                      <form method="post" action="/topics/<%= t.id %>/vote?dir=up">
                        <button class="btn btn--icon" title="Votar positivo">üëç</button>
                      </form>
                      <form method="post" action="/topics/<%= t.id %>/vote?dir=down">
                        <button class="btn btn--icon" title="Votar negativo">üëé</button>
                      </form>
                      <a class="btn btn--neutral" href="/topics/<%= t.id %>/edit" title="Editar">‚úèÔ∏è</a>
                      <form method="post" action="/topics/<%= t.id %>/delete" onsubmit="return confirm('¬øEliminar este topic?')">
                        <button class="btn btn--danger" title="Eliminar">üóëÔ∏è</button>
                      </form>
                    </div>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    <% } %>

    <footer class="footer">
      <span class="muted">CRUD Challenge ‚Ä¢ Express + EJS + SQLite</span>
    </footer>
  </div>
</body>
</html>
